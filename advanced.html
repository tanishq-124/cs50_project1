<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Advanced GPA Calculator</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #e0f7fa, #f1f8e9);
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      animation: fadeIn 1s ease-in;
    }

    .calculator {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
      width: 90%;
      max-width: 900px;
    }

    h1 {
      text-align: center;
      color: #00796b;
    }

    .options {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    select, input[type="text"] {
      padding: 0.4rem;
      font-size: 1rem;
    }

    table {
      width: 100%;
      margin-top: 1rem;
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 0.6rem;
      text-align: center;
    }

    button {
      margin: 0.5rem;
      padding: 0.6rem 1.2rem;
      background-color: #009688;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #00796b;
    }

    .controls {
      text-align: center;
      margin-top: 1rem;
    }

    #gpaResult {
      font-weight: bold;
      font-size: 1.2rem;
      margin-top: 1rem;
      color: #004d40;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="calculator">
    <h1>üéì GPA Calculator</h1>

    <div class="options">
      <label for="semester">Semester:
        <select id="semester">
          <option value="1">Semester 1</option>
          <option value="2">Semester 2</option>
          <option value="3">Semester 3</option>
          <option value="4">Semester 4</option>
        </select>
      </label>

      <label for="branch">Branch:
        <select id="branch">
          <option value="CSE">CSE</option>
          <option value="ECE">ECE</option>
          <option value="ME">ME</option>
          <option value="CE">CE</option>
        </select>
      </label>
    </div>

    <table id="gpaTable">
      <tr>
        <th>Subject</th>
        <th>Credits</th>
        <th>Grade</th>
        <th>Action</th>
      </tr>
    </table>

    <div class="controls">
      <button onclick="addRow()">‚ûï Add Subject</button>
      <button onclick="fillAuto()">ü§ñ Auto Fill</button>
      <button onclick="calculateGPA()">üìä Calculate GPA</button>
      <button onclick="clearRows()">üßπ Clear All</button>
      <button onclick="saveData()">üíæ Save</button>
      <button onclick="exportData()">üì• Export</button>
    </div>

    <p id="gpaResult"></p>
  </div>

  <script>
    const gradePoints = { 'A+': 10, 'A': 9, 'B+': 8, 'B': 7, 'C': 6, 'D': 5, 'F': 0 };
    const sampleSubjects = ['Math', 'Physics', 'Chemistry', 'Biology', 'CS', 'English', 'History'];
    const sampleGrades = Object.keys(gradePoints);

    function addRow(subject = '', credits = '', grade = '') {
      const table = document.getElementById('gpaTable');
      const row = table.insertRow();
      row.innerHTML = `
        <td><input type="text" value="${subject}" placeholder="Subject"></td>
        <td><input type="number" value="${credits}" placeholder="Credits" min="1"></td>
        <td>
          <select>
            <option value="">Grade</option>
            ${sampleGrades.map(g => `<option value="${g}" ${g === grade ? 'selected' : ''}>${g}</option>`).join('')}
          </select>
        </td>
        <td><button onclick="this.parentElement.parentElement.remove()">‚ùå</button></td>
      `;
    }

    function fillAuto() {
      clearRows();
      for (let i = 0; i < 5; i++) {
        const sub = sampleSubjects[i % sampleSubjects.length];
        const cred = Math.floor(Math.random() * 3 + 2);
        const grade = sampleGrades[Math.floor(Math.random() * sampleGrades.length)];
        addRow(sub, cred, grade);
      }
    }

    function calculateGPA() {
      const rows = document.querySelectorAll('#gpaTable tr:not(:first-child)');
      let totalCredits = 0;
      let totalPoints = 0;

      rows.forEach(row => {
        const credits = parseFloat(row.cells[1].children[0].value);
        const grade = row.cells[2].children[0].value;
        const point = gradePoints[grade];

        if (!isNaN(credits) && point !== undefined) {
          totalCredits += credits;
          totalPoints += point * credits;
        }
      });

      const gpa = (totalPoints / totalCredits).toFixed(2);
      document.getElementById('gpaResult').textContent = `Your GPA is: ${isNaN(gpa) ? 'Invalid input' : gpa}`;
    }

    function clearRows() {
      const table = document.getElementById('gpaTable');
      table.innerHTML = `
        <tr>
          <th>Subject</th>
          <th>Credits</th>
          <th>Grade</th>
          <th>Action</th>
        </tr>
      `;
    }

    function saveData() {
      const rows = document.querySelectorAll('#gpaTable tr:not(:first-child)');
      const data = Array.from(rows).map(row => ({
        subject: row.cells[0].children[0].value,
        credits: row.cells[1].children[0].value,
        grade: row.cells[2].children[0].value
      }));
      localStorage.setItem('gpaData', JSON.stringify(data));
      alert('Saved locally!');
    }

    function exportData() {
      const rows = document.querySelectorAll('#gpaTable tr:not(:first-child)');
      let csv = 'Subject,Credits,Grade\n';
      rows.forEach(row => {
        const subject = row.cells[0].children[0].value;
        const credits = row.cells[1].children[0].value;
        const grade = row.cells[2].children[0].value;
        csv += `${subject},${credits},${grade}\n`;
      });

      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'gpa_data.csv';
      a.click();
    }

    window.onload = function () {
      const saved = localStorage.getItem('gpaData');
      if (saved) {
        const data = JSON.parse(saved);
        clearRows();
        data.forEach(row => addRow(row.subject, row.credits, row.grade));
      }
    };
  </script>
</body>
</html>
